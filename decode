#!/bin/sh

i200='🫂'
i50='💖'
i10='✨'
i5='🥺'
i1=','
i0='❤️'
bss='👉'
bse='👈'

buf() {
	char="${l%"${l#?}"}"
	buf="$buf$char"

	case $buf in
		"$i0")
			printf '\0'
			l="${l#?}"
			sum=0
			buf=''
			return
			# continue
			;;
		"$i200")
			buf=
			: $((sum+=200))
			;;
		"$i50")
			buf=
			: $((sum+=50))
			;;
		"$i10")
			buf=
			: $((sum+=10))
			;;
		"$i5")
			buf=
			: $((sum+=5))
			;;
		"$i1")
			buf=
			: $((sum+=1))
			;;
		"$bss")
			printf "\\$(printf '%o' "$sum")"
			sum=0
			buf=
			;;
		"$bse")
			buf=
			;;
	esac
	l="${l#?}"
}

ch() {
	n=0
	for i in "$bse" "$bss" "$i0" "$i200" "$i50" "$i10" \
					"$i5" "$i1"; do
		[ "${l%"${l#"$i"}"}" != "$i" ] && {
			: $((n+=1))
			continue
		}
		case $n in
			0) ;;
			1)
				printf "\\$(printf '%o' "$sum")"
				sum=0
				;;
			2)
				printf '\0'
				sum=0
				;;
			3) : $((sum+=200)) ;;
			4) : $((sum+=50))  ;;
			5) : $((sum+=10))  ;;
			6) : $((sum+=5))   ;;
			7) : $((sum+=1))   ;;
		esac
		: $((n+=1))
		l="${l#"$i"}"
		break
	done
}

sum=0
while read -r l; do
	while [ -n "$l" ]; do
		buf
	done
done
